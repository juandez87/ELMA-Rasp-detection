<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elma: 180° Range Search Detection Object</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elma
   </div>
   <div id="projectbrief">An event loop manager for embedded systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">180° Range Search Detection Object </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Description </h2>
<p>Combining an ultrasonic Sensor and a Servo Motor with the platform Raspberry Pi 3 I will build a simple system that can search and detect an Object. This detection system will be moving in a range of 180° back and forward stopping when detecting the object within a distance between 9 and 11 inches.</p>
<p>The Primary goals are:</p><ul>
<li>Implement ELMA into Raspberry Pi.</li>
<li>Define a StateMachine called 'detection' with ELMA combining an ultrasonic sensor and a servo motor. <div class="image">
<img src="images/Statemachine_detection.PNG" width="620"/>
</div>
&lt;/image&gt;</li>
<li>Utilize a library that allows me to use the bi-directional GPIO pins in C++.</li>
<li>Implement google test.</li>
</ul>
<h2>Resources </h2>
<p>To complete this project I will use:</p>
<ul>
<li>Raspberry Pi 3 B+</li>
<li>SG90 Micro Servo</li>
<li>Ultrasonic Module Distance Sensor HC-SR04</li>
</ul>
<h2>Execution </h2>
<p>To run the detection program, type </p><pre class="fragment">sudo ./examples/bin/main
</pre><p>the program detection has to be started manually via the keyboard, it also can stop and reset, via these keys:</p><ul>
<li><b>s</b>: Start or stop</li>
<li><b>r</b>: Reset</li>
<li><b>q</b>: Quit</li>
</ul>
<h2>Milestones </h2>
<ol type="1">
<li>【Done】Assemble all the components to connect to the raspberry &ndash; 3/11</li>
</ol>
<ol type="1">
<li>【Done】build the StateMachine 'detection' &ndash; 3/13</li>
</ol>
<ol type="1">
<li>build the Googletest for 'detection' &ndash; 3/14</li>
</ol>
<ol type="1">
<li>【Done】port the ELMA libraries in to raspberry. &ndash;3/16</li>
</ol>
<ol type="1">
<li>【Done】completing the API documentation. &ndash; 3/17</li>
</ol>
<ol type="1">
<li>【Done】completing final project and submission. &ndash;3/21</li>
</ol>
<h2>Updates </h2>
<p>For these Milestones I have accomplish so far in the project:</p>
<ul>
<li><p class="startli">Assemble all the components to connect the raspberry. Here are the schematics made on Fritzing software of the connections. </p><div class="image">
<img src="images/circuit_schem.png" width="420"/>
</div>
<p>&lt;/image&gt; </p><div class="image">
<img src="images/project_bb.png" width="420"/>
</div>
<p>&lt;/image&gt;</p>
<p class="startli">Also I added 1 LED with 3 colors to test that the wiringPi libraries are working with ELMA properly after compiling the code.</p>
</li>
<li><p class="startli">Port the C++ libraries in to raspberry. I will change this Milestone instead of C++ libraries it will be the <a href="https://github.com/klavinslab/elma/">ELMA</a> and <a href="http://www.wiringpi.com/">WiringPi</a> libraries since most of the C++ libraries are already included. The WiringPi library allows me to get access and control the GPIO pins from the programming language of C and C++.</p>
<p class="startli">I tried to install ELMA in both ways, first from the Docker file and second from the step by step of the Unix systems (e.g. Raspbian) instructions.</p>
<p class="startli">From the Docker file it successfully installed but with the inconvenient that it only run the Makefile and executes the code inside the Docker container not outside. Plus it is complex to control the GPIO pins from the container even if the libraries of WiringPi are installed and included.</p>
<p class="startli">In the second way following the instructions on how to install Elma in a Unix systems (e.g. Raspbian) it works great plus runs the code normally and lets me use the WiringPi library in the examples folder keeping in mind that on the Makefile you have to add the -lwiringPi like this. </p><pre class="fragment">  #Flags, Libraries and Includes
  CFLAGS      := -fsanitize=address -ggdb
  LIB         := -lgtest -lpthread -lasan -lelma -lssl -lcrypto -lwiringPi
  INCLUDE     := -I..
  LIBDIR      := -L../lib
  ELMALIB     := ../lib/libelma.a
</pre></li>
<li><p class="startli">Build the StateMachine 'detection': I Build my code base on the stopwach of <a href="https://github.com/klavinslab/elma_project.git">elma_project</a> combining the features of accessing the time in milliseconds using it to increment and decrement the pulse wide modulation (PWM) in a range of 180° will help the program avoid using unnecessary loops or delays making it more efficient. Also I will use the User interface so I can start the program and see the distance of the object in centimeters and Inches plus the position of the servo in degrees.</p>
<p class="startli">Another feature is the addition of <a href="http://www.wiringpi.com/">WiringPi</a> Library to access and control the GPIO ports. here is a definition of the ports that are going to be use. </p><pre class="fragment">  #define BLUE 1
  #define GREEN 2 
  #define RED 3
  #define ECHO 0
  #define TRIGER 7
  #define PWM 4

  void Detection::setup(){
      wiringPiSetup () ;
      pinMode (BLUE, OUTPUT) ;
      pinMode (GREEN, OUTPUT) ;
      pinMode (RED, OUTPUT) ;
      pinMode (ECHO, INPUT) ;
      pinMode (TRIGER, OUTPUT) ;
      softPwmCreate (PWM, 0, 200) ;
  }
</pre><p class="startli">Also I added a function setup() in detection to initialize all the GPIO Pins.</p>
</li>
<li><p class="startli">Build the google testof detection: For the Practical test I will trace an area with the distance and angles of measurements, plus adding objects in different places so that the servo motor is stopping when the ultrasonic sensor measures the distance to that object Like the image below.</p>
<div class="image">
<img src="images/test.PNG" width="420"/>
</div>
<p>&lt;/image&gt; </p><div class="image">
<img src="images/test.jpg" width="420"/>
</div>
<p>&lt;/image&gt;</p>
<p class="startli">the test work</p>
<p class="startli">To try google test I will put objects in front of the HC-SR04 sensor in different distances so it can determine if the object is in the range of 9 and 11 inches also giving me an output response if the motor should be running or stop. also if the user doesnt have an Ultrasonic sensor they can manually type the distance in a variable ot see the reponse. </p>
</li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
  <hr class="footer"/><address class="footer"><small>
  Developed by <a href="http://klavinslab.org">Eric Klavins</a> for UW ECE P 520<br>
  Generated on Fri Mar 22 2019 05:47:36 for Elma by &#160;<a href="http://www.doxygen.org/index.html">
  Doxygen
  </a> 1.8.13
  </small></address>
  </body>
  </html>