<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elma: README.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elma
   </div>
   <div id="projectbrief">An event loop manager for embedded systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">README.md</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;180° Range Search Detection Object </div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;===</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Description </div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;---</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Combining an ultrasonic Sensor and a Servo Motor with the platform Raspberry Pi 3 I will build a simple system that can search and detect an Object. This detection system will be moving in a range of 180° back and forward stopping when detecting the object within a distance between 9 and 11 inches. </div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;The Primary goals are:</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;- Implement ELMA into Raspberry Pi.</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;- Define a StateMachine called &#39;detection&#39; with ELMA combining an ultrasonic sensor and a servo motor.</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    &lt;img src=&quot;images/Statemachine_detection.PNG&quot; width=&quot;620&quot;&gt;&lt;/image&gt;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;- Utilize a library that allows me to use the bi-directional GPIO pins in C++.</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;- Implement google test.</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;Resources</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;---</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;To complete this project I will use:</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;- Raspberry Pi 3 B+ </div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;- SG90 Micro Servo  </div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;- Ultrasonic Module Distance Sensor HC-SR04</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;Milestones</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;---</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;1. 【Done】Assemble all the components to connect to the raspberry -- 3/11</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;1. 【Done】build the StateMachine &#39;detection&#39; -- 3/13</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;1. build the Googletest for &#39;detection&#39; -- 3/14</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;1. 【Done】port the ELMA libraries in to raspberry. --3/16</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;1. completing the API documentation. -- 3/17</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;1. completing final project and submission. --3/21</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;Updates</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;---</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;For these Milestones I have accomplish so far in the project:</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;- Assemble all the components to connect the raspberry. Here are the schematics made on Fritzing software of the connections.  </div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  &lt;img src=&quot;images/circuit_schem.png&quot; width=&quot;420&quot;&gt;&lt;/image&gt; &lt;img src=&quot;images/project_bb.png&quot; width=&quot;420&quot;&gt;&lt;/image&gt;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  </div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  Also I added 1 LED with 3 colors to test that the wiringPi libraries are working with ELMA properly after compiling the code.</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;- Port the C++ libraries in to raspberry. I will change this Milestone instead of C++ libraries it will be the [ELMA]( https://github.com/klavinslab/elma/) and [WiringPi](http://www.wiringpi.com/) libraries since most of the C++ libraries are already included. The WiringPi library allows me to get access and control the GPIO pins from the programming language of C and C++. </div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  </div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  I tried to install ELMA in both ways, first from the Docker file and second from the step by step of the Unix systems (e.g. Raspbian) instructions. </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  From the Docker file it successfully installed but with the inconvenient that it only run the Makefile and executes the code inside the Docker container not outside. Plus it is complex to control the GPIO pins from the container even if the libraries of WiringPi are installed and included. </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  In the second way following the instructions on how to install Elma in a Unix systems (e.g. Raspbian) it works great plus runs the code normally and lets me use the WiringPi library in the examples folder keeping in mind that on the Makefile you have to add the -lwiringPi like this.</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        #Flags, Libraries and Includes</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        CFLAGS      := -fsanitize=address -ggdb</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        LIB         := -lgtest -lpthread -lasan -lelma -lssl -lcrypto -lwiringPi</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        INCLUDE        := -I..</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        LIBDIR     := -L../lib</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        ELMALIB        := ../lib/libelma.a</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;- Build the StateMachine &#39;detection&#39;: I Build my code base on the stopwach of [elma_project](https://github.com/klavinslab/elma_project.git) combining the features of accessing the time in milliseconds using it to increment the pulse wide modulation (PWM) in a range of 180° will help the program avoid using unnecessary loops or delays making it more efficient. Also I will use the User interface so I can start the program and see the distance of the object in centimeters and Inches plus the position of the servo in degrees.</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  Another feature is the addition of [WiringPi](http://www.wiringpi.com/) Library to access and control the GPIO ports. here is a definition of the ports that are going to be use.</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        #define BLUE 1</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        #define GREEN 2 </div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        #define RED 3</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        #define ECHO 0</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        #define TRIGER 7</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        #define PWM 4</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        void Detection::setup(){</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            wiringPiSetup () ;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            pinMode (BLUE, OUTPUT) ;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            pinMode (GREEN, OUTPUT) ;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            pinMode (RED, OUTPUT) ;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            pinMode (ECHO, INPUT) ;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            pinMode (TRIGER, OUTPUT) ;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            softPwmCreate (PWM, 0, 200) ;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        </div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  Also I added a function setup() in detection to initialize all the GPIO Pins.</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;- Build the google testof detection: For the Practical test I will trace an area with the distance and angles of measurements, plus adding objects in different places so that the servo motor is stopping when the ultrasonic sensor measures the distance to that object Like the image below.</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  &lt;img src=&quot;images/test.PNG&quot; width=&quot;420&quot;&gt;&lt;/image&gt;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  For the google test I will put objects in front of the HC-SR04 sensor in different distances so it can determine if the object is in the range of 9 and 11 and with that output the response if the motor should be running or stop. also if the user doesnt have an Ultrasonic sensor they can manually type the distance in a variable ot see the reponse.</div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
  <hr class="footer"/><address class="footer"><small>
  Developed by <a href="http://klavinslab.org">Eric Klavins</a> for UW ECE P 520<br>
  Generated on Fri Mar 22 2019 00:58:00 for Elma by &#160;<a href="http://www.doxygen.org/index.html">
  Doxygen
  </a> 1.8.13
  </small></address>
  </body>
  </html>